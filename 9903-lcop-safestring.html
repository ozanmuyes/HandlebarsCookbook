<!DOCTYPE html>                                                                                                       
<html lang="en">
<head>
 <meta charset="utf-8">
 <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
 <title>Handlebars Cookbook - LightnCandy option: safestring</title>
 <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
 <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css" rel="stylesheet">
 <link href="style.css" rel="stylesheet">
 <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAPzlzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAARAAAAARAAAAEQAAARAAAAABEAARAiIiIiARABECACIAIBEAEQIAIgAgEQARAgAiACARARECAAAAIBEREQIAAAAgERARAgAiACARABECACIAIBEAEQIAIgAgEQARAiIiIiARAAEQAAAAARAAABEAAAARAAAAARAAARAADzzwAA5+cAAM/zAACQCQAAkAkAAJAJAACQCQAAEAgAABAIAACQCQAAkAkAAJAJAACQCQAAz/MAAOfnAADzzwAA" rel="icon" type="image/x-icon" />
 <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
 <![endif]-->
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
 <div class="container">
  <div class="navbar-header">
   <a class="navbar-brand" href="./"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Handlebars Cookbook</a>
  </div>
  <ul class="nav navbar-nav">
   <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Index <span class="caret"></span>
    </a>
    <ol class="dropdown-menu">
<li><a href="index.html">1. About this book</a></li>
<li><a href="0002-install.html">2. Create your project</a></li>
<li><a href="0003-hello.html">3. Hello World</a></li>
<li><a href="0004-simple-variable.html">4. Simple Variable</a></li>
<li><a href="0005-variable-escape.html">5. Variable Escaping</a></li>
<li><a href="0006-raw.html">6. Raw Output</a></li>
<li><a href="0007-specific-values.html">7. Specific Values</a></li>
<li><a href="0008-block.html">8. Block</a></li>
<li><a href="0009-inverted-block.html">9. Inverted Block</a></li>
<li><a href="0010-comment.html">10. Comment</a></li>
<li><a href="0011-partial.html">11. Partials</a></li>
<li><a href="0012-delimiter.html">12. Set Delimiter</a></li>
<li><a href="0013-dotnotation.html">13. Dot Notation</a></li>
<li><a href="0014-path.html">14. Handlebars: Path</a></li>
<li><a href="0015-hbcomment.html">15. Handlebars: Extended Comment</a></li>
<li><a href="0016-if.html">16. Handlebars: Built-in block helper - #if</a></li>
<li><a href="0017-unless.html">17. Handlebars: Built-in block helper - #unless</a></li>
<li><a href="0018-with.html">18. Handlebars: Built-in block helper - #with</a></li>
<li><a href="0019-each.html">19. Handlebars: Built-in block helper - #each</a></li>
<li><a href="0020-lookup.html">20. Handlebars: Built-in helper - lookup</a></li>
<li><a href="0021-customhelper.html">21. Handlebars: Custom Helper</a></li>
<li><a href="0022-blockhelper.html">22. Handlebars: Block Custom Helper</a></li>
<li><a href="0023-namedarguments.html">23. Handlebars: Named Arguments</a></li>
<li><a href="0024-partialcontext.html">24. Handlebars: Change Partial Context</a></li>
<li><a href="0025-parentcontext.html">25. Handlebars: Parent Context</a></li>
<li><a href="0026-subexpression.html">26. Handlebars: Subexpression</a></li>
<li><a href="0027-advancedvariable.html">27. Handlebars: Advanced Variable</a></li>
<li><a href="0028-dynamicpartial.html">28. Handlebars: Dynamic Partial</a></li>
<li><a href="0029-safestring.html">29. Handlebars: Use SafeString</a></li>
<li><a href="0030-changecontext.html">30. Handlebars: Change Context</a></li>
<li><a href="9000-quickstart.html">31. LightnCandy: Quick Start</a></li>
<li><a href="9001-customhelper.html">32. LightnCandy: Custom Helper</a></li>
<li><a href="9002-helperoptions.html">33. LightnCandy: The $options Object</a></li>
<li><a href="9003-helperescaping.html">34. LightnCandy: Use SafeString</a></li>
<li><a href="9004-partials.html">35. LightnCandy: Deep Dive Partials</a></li>
<li><a href="9900-lc-options.html">36. LightnCandy options</a></li>
<li><a href="9901-lcop-helperresolver.html">37. LightnCandy option: helperresolver</a></li>
<li><a href="9902-lcop-partialresolver.html">38. LightnCandy option: partialresolver</a></li>
<li><a href="9903-lcop-safestring.html">39. LightnCandy option: safestring</a></li>
<li><a href="LC-FLAG_ADVARNAME.html">40. LightnCandy option: FLAG_ADVARNAME</a></li>
<li><a href="LC-FLAG_BESTPERFORMANCE.html">41. LightnCandy option: FLAG_BESTPERFORMANCE</a></li>
<li><a href="LC-FLAG_ECHO.html">42. LightnCandy option: FLAG_ECHO</a></li>
<li><a href="LC-FLAG_ELSE.html">43. LightnCandy option: FLAG_ELSE</a></li>
<li><a href="LC-FLAG_ERROR_EXCEPTION.html">44. LightnCandy option: FLAG_ERROR_EXCEPTION</a></li>
<li><a href="LC-FLAG_ERROR_LOG.html">45. LightnCandy option: FLAG_ERROR_LOG</a></li>
<li><a href="LC-FLAG_ERROR_SKIPPARTIAL.html">46. LightnCandy option: FLAG_ERROR_SKIPPARTIAL</a></li>
<li><a href="LC-FLAG_EXTHELPER.html">47. LightnCandy option: FLAG_EXTHELPER</a></li>
<li><a href="LC-FLAG_HBESCAPE.html">48. LightnCandy option: FLAG_HBESCAPE</a></li>
<li><a href="LC-FLAG_INSTANCE.html">49. LightnCandy option: FLAG_INSTANCE</a></li>
<li><a href="LC-FLAG_JS.html">50. LightnCandy option: FLAG_JS</a></li>
<li><a href="LC-FLAG_JSLENGTH.html">51. LightnCandy option: FLAG_JSLENGTH</a></li>
<li><a href="LC-FLAG_JSOBJECT.html">52. LightnCandy option: FLAG_JSOBJECT</a></li>
<li><a href="LC-FLAG_JSTRUE.html">53. LightnCandy option: FLAG_JSTRUE</a></li>
<li><a href="LC-FLAG_METHOD.html">54. LightnCandy option: FLAG_METHOD</a></li>
<li><a href="LC-FLAG_NAMEDARG.html">55. LightnCandy option: FLAG_NAMEDARG</a></li>
<li><a href="LC-FLAG_NOESCAPE.html">56. LightnCandy option: FLAG_NOESCAPE</a></li>
<li><a href="LC-FLAG_PARENT.html">57. LightnCandy option: FLAG_PARENT</a></li>
<li><a href="LC-FLAG_PARTIALNEWCONTEXT.html">58. LightnCandy option: FLAG_PARTIALNEWCONTEXT</a></li>
<li><a href="LC-FLAG_PROPERTY.html">59. LightnCandy option: FLAG_PROPERTY</a></li>
<li><a href="LC-FLAG_RUNTIMEPARTIAL.html">60. LightnCandy option: FLAG_RUNTIMEPARTIAL</a></li>
<li><a href="LC-FLAG_SLASH.html">61. LightnCandy option: FLAG_SLASH</a></li>
<li><a href="LC-FLAG_STANDALONEPHP.html">62. LightnCandy option: FLAG_STANDALONEPHP</a></li>
<li><a href="LC-FLAG_THIS.html">63. LightnCandy option: FLAG_THIS</a></li>
</ol>
   </li>
   <li><a href="#search"><label for="gsc-i-id1"><span class="glyphicon glyphicon-search"></span> Search</label></a></li>
  </ul>
  <ul class="nav navbar-nav navbar-right">
   <li><a href="https://github.com/zordius/HandlebarsCookbook"><span class="glyphicon glyphicon-circle-arrow-right" aria-hidden="true"></span> Go to Github</a></li>
  </ul>
 </div>
</nav>
<div class="container-fluid">
 <h1>LightnCandy option: safestring</h1>
 <p>Use <code>safestring</code> option to provide your own SafeString implementation or change the default <code>LS</code> classname when <code>FLAG_STANDALONEPHP</code> is enabled.</p>
     <a name="MySafeString"></a><a class="glyphicon glyphicon-pushpin" href="#MySafeString"></a>
<h2>MySafeString</h2>
<p class="note">You should provide <code>__toString()</code>. If you use <code>\LightnCandy\SafeString</code> in your custom helper, it will be replaced by your safestring automatically.</p>
<div class="text-center">Source Code <textarea class="copy" id="code_rJz_dtg9rg">require_once('./vendor/autoload.php');
use LightnCandy\LightnCandy;

class MySafeString {
    public function __toString() {
        return 'Yes! You&me!';
    }
}

$template = "{{foo}}, {{bar}}";

$phpStr = LightnCandy::compile($template, array(
    'flags' => LightnCandy::FLAG_HANDLEBARS | LightnCandy::FLAG_STANDALONEPHP,
    'helpers' => array(
        'foo' => function () {
            return new MySafeString();
        },
        'bar' => function () {
            return new \LightnCandy\SafeString('He&She!');
        }
    ),
    'safestring' => 'MySafeString'
));

$renderer = LightnCandy::prepare($phpStr);
echo $renderer();</textarea><button class="btn btn-primary" data-clipboard-target="#code_rJz_dtg9rg">Copy to clipboard</button></div><pre id="precode_rJz_dtg9rg"><code class="language-php"><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'./vendor/autoload.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">LightnCandy<span class="token punctuation">\</span>LightnCandy</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MySafeString</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'Yes! You&amp;me!'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$template</span> <span class="token operator">=</span> <span class="token string">"{{foo}}, {{bar}}"</span><span class="token punctuation">;</span>

<span class="token variable">$phpStr</span> <span class="token operator">=</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string">'flags'</span> <span class="token operator">=</span><span class="token operator">></span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FLAG_HANDLEBARS</span> <span class="token operator">|</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FLAG_STANDALONEPHP</span><span class="token punctuation">,</span>
    <span class="token string">'helpers'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string">'foo'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MySafeString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'bar'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>LightnCandy<span class="token punctuation">\</span>SafeString</span><span class="token punctuation">(</span><span class="token string">'He&amp;She!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'safestring'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'MySafeString'</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$renderer</span> <span class="token operator">=</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token variable">$phpStr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3>Output</h3>
<pre><code>Yes! You&amp;me!, Yes! You&amp;me!</code></pre>
<a name="RenameLSclass"></a><a class="glyphicon glyphicon-pushpin" href="#RenameLSclass"></a>
<h2>Rename LS class</h2>
<p class="note">If the class is not implemeted, then the <code>\LightnCandy\SafeString</code> class will be used.</p>
<div class="text-center">Source Code <textarea class="copy" id="code_SyQuOKe9Se">require_once('./vendor/autoload.php');
use LightnCandy\LightnCandy;

$template = "{{foo}}, {{bar}}";

$phpStr = LightnCandy::compile($template, array(
    'flags' => LightnCandy::FLAG_HANDLEBARS | LightnCandy::FLAG_STANDALONEPHP,
    'helpers' => array(
        'foo' => function () {
            return new MySafeString('You&Me!');
        },
        'bar' => function () {
            return new \LightnCandy\SafeString('He&She!');
        }
    ),
    'safestring' => 'MySafeString'
));

$renderer = LightnCandy::prepare($phpStr);
echo "The Code:\n$phpStr\n\n";
echo "===========================\nThe Output:\n" . $renderer();</textarea><button class="btn btn-primary" data-clipboard-target="#code_SyQuOKe9Se">Copy to clipboard</button></div><pre id="precode_SyQuOKe9Se"><code class="language-php"><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'./vendor/autoload.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">LightnCandy<span class="token punctuation">\</span>LightnCandy</span><span class="token punctuation">;</span>

<span class="token variable">$template</span> <span class="token operator">=</span> <span class="token string">"{{foo}}, {{bar}}"</span><span class="token punctuation">;</span>

<span class="token variable">$phpStr</span> <span class="token operator">=</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string">'flags'</span> <span class="token operator">=</span><span class="token operator">></span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FLAG_HANDLEBARS</span> <span class="token operator">|</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FLAG_STANDALONEPHP</span><span class="token punctuation">,</span>
    <span class="token string">'helpers'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string">'foo'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MySafeString</span><span class="token punctuation">(</span><span class="token string">'You&amp;Me!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'bar'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>LightnCandy<span class="token punctuation">\</span>SafeString</span><span class="token punctuation">(</span><span class="token string">'He&amp;She!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'safestring'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'MySafeString'</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$renderer</span> <span class="token operator">=</span> LightnCandy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token variable">$phpStr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">"The Code:\n$phpStr\n\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">"===========================\nThe Output:\n"</span> <span class="token punctuation">.</span> <span class="token variable">$renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3>Output</h3>
<pre><code>The Code:
 function lcr586c79706521ehbch($cx, $ch, $vars, $op, $inverted, $cb &#x3D; null, $else &#x3D; null) {
  $isBlock &#x3D; (is_object($cb) &amp;&amp; ($cb instanceof \Closure));

  if (isset($cx[&#x27;blparam&#x27;][0][$ch])) {
   return $cx[&#x27;blparam&#x27;][0][$ch];
  }

  $args &#x3D; $vars[0];
  $options &#x3D; array(
   &#x27;name&#x27; &#x3D;&gt; $ch,
   &#x27;hash&#x27; &#x3D;&gt; $vars[1],
   &#x27;contexts&#x27; &#x3D;&gt; count($cx[&#x27;scopes&#x27;]) ? $cx[&#x27;scopes&#x27;] : array(null),
   &#x27;fn.blockParams&#x27; &#x3D;&gt; 0,
  );

  if ($isBlock) {
   $options[&#x27;_this&#x27;] &#x3D; &amp;$op;
  } else {
   $options[&#x27;_this&#x27;] &#x3D; &amp;$inverted;
  }

  if (isset($vars[2])) {
   $options[&#x27;fn.blockParams&#x27;] &#x3D; count($vars[2]);
  }

  // $invert the logic
  if ($inverted) {
   $tmp &#x3D; $else;
   $else &#x3D; $cb;
   $cb &#x3D; $tmp;
  }

  if ($isBlock) {
   $options[&#x27;fn&#x27;] &#x3D; function ($context &#x3D; &#x27;_NO_INPUT_HERE_&#x27;, $data &#x3D; null) use ($cx, &amp;$op, $cb, $options, $vars) {
    if ($cx[&#x27;flags&#x27;][&#x27;echo&#x27;]) {
     ob_start();
    }
    if (isset($data[&#x27;data&#x27;])) {
     $old_spvar &#x3D; $cx[&#x27;sp_vars&#x27;];
     $cx[&#x27;sp_vars&#x27;] &#x3D; array_merge(array(&#x27;root&#x27; &#x3D;&gt; $old_spvar[&#x27;root&#x27;]), $data[&#x27;data&#x27;], array(&#x27;_parent&#x27; &#x3D;&gt; $old_spvar));
    }
    $ex &#x3D; false;
    if (isset($data[&#x27;blockParams&#x27;]) &amp;&amp; isset($vars[2])) {
     $ex &#x3D; array_combine($vars[2], array_slice($data[&#x27;blockParams&#x27;], 0, count($vars[2])));
     array_unshift($cx[&#x27;blparam&#x27;], $ex);
    } else if (isset($cx[&#x27;blparam&#x27;][0])) {
     $ex &#x3D; $cx[&#x27;blparam&#x27;][0];
    }
    if (($context &#x3D;&#x3D;&#x3D; &#x27;_NO_INPUT_HERE_&#x27;) || ($context &#x3D;&#x3D;&#x3D; $op)) {
     $ret &#x3D; $cb($cx, is_array($ex) ? lcr586c79706521em($cx, $op, $ex) : $op);
    } else {
     $cx[&#x27;scopes&#x27;][] &#x3D; $op;
     $ret &#x3D; $cb($cx, is_array($ex) ? lcr586c79706521em($cx, $context, $ex) : $context);
     array_pop($cx[&#x27;scopes&#x27;]);
    }
    if (isset($data[&#x27;data&#x27;])) {
     $cx[&#x27;sp_vars&#x27;] &#x3D; $old_spvar;
    }
    return $cx[&#x27;flags&#x27;][&#x27;echo&#x27;] ? ob_get_clean() : $ret;
   };
  }

  if ($else) {
   $options[&#x27;inverse&#x27;] &#x3D; function ($context &#x3D; &#x27;_NO_INPUT_HERE_&#x27;) use ($cx, $op, $else) {
    if ($cx[&#x27;flags&#x27;][&#x27;echo&#x27;]) {
     ob_start();
    }
    if ($context &#x3D;&#x3D;&#x3D; &#x27;_NO_INPUT_HERE_&#x27;) {
     $ret &#x3D; $else($cx, $op);
    } else {
     $cx[&#x27;scopes&#x27;][] &#x3D; $op;
     $ret &#x3D; $else($cx, $context);
     array_pop($cx[&#x27;scopes&#x27;]);
    }
    return $cx[&#x27;flags&#x27;][&#x27;echo&#x27;] ? ob_get_clean() : $ret;
   };
  } else {
   $options[&#x27;inverse&#x27;] &#x3D; function () {
    return &#x27;&#x27;;
   };
  }

  if ($cx[&#x27;flags&#x27;][&#x27;spvar&#x27;]) {
   $options[&#x27;data&#x27;] &#x3D; $cx[&#x27;sp_vars&#x27;];
  }

  $args[] &#x3D; $options;
  $e &#x3D; null;
  $r &#x3D; true;

  try {
   $r &#x3D; call_user_func_array($cx[&#x27;helpers&#x27;][$ch], $args);
  } catch (\Exception $E) {
   $e &#x3D; &quot;Runtime: call custom helper &#x27;$ch&#x27; error: &quot; . $E-&gt;getMessage();
  }

  if($e !&#x3D;&#x3D; null) {
   lcr586c79706521eerr($cx, $e);
  }

  return $r;
 }

 function lcr586c79706521eencq($cx, $var) {
  if ($var instanceof MySafeString) {
   return (string)$var;
  }

  return str_replace(array(&#x27;&#x3D;&#x27;, &#x27;&#x60;&#x27;, &#x27;&amp;#039;&#x27;), array(&#x27;&amp;#x3D;&#x27;, &#x27;&amp;#x60;&#x27;, &#x27;&amp;#x27;&#x27;), htmlspecialchars(lcr586c79706521eraw($cx, $var), ENT_QUOTES, &#x27;UTF-8&#x27;));
 }

 function lcr586c79706521em($cx, $a, $b) {
  if (is_array($b)) {
   if ($a &#x3D;&#x3D;&#x3D; null) {
    return $b;
   } else if (is_array($a)) {
    return array_merge($a, $b);
   } else if (($cx[&#x27;flags&#x27;][&#x27;method&#x27;] || $cx[&#x27;flags&#x27;][&#x27;prop&#x27;]) &amp;&amp; is_object($a)) {
    foreach ($b as $i &#x3D;&gt; $v) {
     $a-&gt;$i &#x3D; $v;
    }
   }
  }
  return $a;
 }

 function lcr586c79706521eerr($cx, $err) {
  if ($cx[&#x27;flags&#x27;][&#x27;debug&#x27;] &amp; $cx[&#x27;constants&#x27;][&#x27;DEBUG_ERROR_LOG&#x27;]) {
   error_log($err);
   return;
  }
  if ($cx[&#x27;flags&#x27;][&#x27;debug&#x27;] &amp; $cx[&#x27;constants&#x27;][&#x27;DEBUG_ERROR_EXCEPTION&#x27;]) {
   throw new \Exception($err);
  }
 }

 function lcr586c79706521eraw($cx, $v) {
  if ($v &#x3D;&#x3D;&#x3D; true) {
   if ($cx[&#x27;flags&#x27;][&#x27;jstrue&#x27;]) {
    return &#x27;true&#x27;;
   }
  }

  if (($v &#x3D;&#x3D;&#x3D; false)) {
   if ($cx[&#x27;flags&#x27;][&#x27;jstrue&#x27;]) {
    return &#x27;false&#x27;;
   }
  }

  if (is_array($v)) {
   if ($cx[&#x27;flags&#x27;][&#x27;jsobj&#x27;]) {
    if (count(array_diff_key($v, array_keys(array_keys($v)))) &gt; 0) {
     return &#x27;[object Object]&#x27;;
    } else {
     $ret &#x3D; array();
     foreach ($v as $k &#x3D;&gt; $vv) {
      $ret[] &#x3D; lcr586c79706521eraw($cx, $vv);
     }
     return join(&#x27;,&#x27;, $ret);
    }
   } else {
    return &#x27;Array&#x27;;
   }
  }

  return &quot;$v&quot;;
 }

if (!class_exists(&quot;MySafeString&quot;)) {
class MySafeString {
 public static $jsContext &#x3D; array (
  &#x27;flags&#x27; &#x3D;&gt; 
  array (
    &#x27;jstrue&#x27; &#x3D;&gt; 1,
    &#x27;jsobj&#x27; &#x3D;&gt; 1,
  ),
);
    public function __construct($str, $escape &#x3D; false) {
        $this-&gt;string &#x3D; $escape ? (($escape &#x3D;&#x3D;&#x3D; &#x27;encq&#x27;) ? static::encq(static::$jsContext, $str) : static::enc(static::$jsContext, $str)) : $str;
    }
    public function __toString() {
        return $this-&gt;string;
    }
    public static function stripExtendedComments($template) {
        return preg_replace(static::EXTENDED_COMMENT_SEARCH, &#x27;{{! }}&#x27;, $template);
    }
    public static function escapeTemplate($template) {
        return addcslashes(addcslashes($template, &#x27;\\&#x27;), &quot;&#x27;&quot;);
    }
    public static function raw($cx, $v) {
        if ($v &#x3D;&#x3D;&#x3D; true) {
            if ($cx[&#x27;flags&#x27;][&#x27;jstrue&#x27;]) {
                return &#x27;true&#x27;;
            }
        }

        if (($v &#x3D;&#x3D;&#x3D; false)) {
            if ($cx[&#x27;flags&#x27;][&#x27;jstrue&#x27;]) {
                return &#x27;false&#x27;;
            }
        }

        if (is_array($v)) {
            if ($cx[&#x27;flags&#x27;][&#x27;jsobj&#x27;]) {
                if (count(array_diff_key($v, array_keys(array_keys($v)))) &gt; 0) {
                    return &#x27;[object Object]&#x27;;
                } else {
                    $ret &#x3D; array();
                    foreach ($v as $k &#x3D;&gt; $vv) {
                        $ret[] &#x3D; static::raw($cx, $vv);
                    }
                    return join(&#x27;,&#x27;, $ret);
                }
            } else {
                return &#x27;Array&#x27;;
            }
        }

        return &quot;$v&quot;;
    }
    public static function enc($cx, $var) {
        return htmlspecialchars(static::raw($cx, $var), ENT_QUOTES, &#x27;UTF-8&#x27;);
    }
    public static function encq($cx, $var) {
        return str_replace(array(&#x27;&#x3D;&#x27;, &#x27;&#x60;&#x27;, &#x27;&amp;#039;&#x27;), array(&#x27;&amp;#x3D;&#x27;, &#x27;&amp;#x60;&#x27;, &#x27;&amp;#x27;&#x27;), htmlspecialchars(static::raw($cx, $var), ENT_QUOTES, &#x27;UTF-8&#x27;));
    }
}
}
return function ($in &#x3D; null, $options &#x3D; null) {
    $helpers &#x3D; array(            &#x27;foo&#x27; &#x3D;&gt; function() {
            return new MySafeString(&#x27;You&amp;Me!&#x27;);
        },
            &#x27;bar&#x27; &#x3D;&gt; function() {
            return new MySafeString(&#x27;He&amp;She!&#x27;);
        },
);
    $partials &#x3D; array();
    $cx &#x3D; array(
        &#x27;flags&#x27; &#x3D;&gt; array(
            &#x27;jstrue&#x27; &#x3D;&gt; false,
            &#x27;jsobj&#x27; &#x3D;&gt; false,
            &#x27;spvar&#x27; &#x3D;&gt; true,
            &#x27;prop&#x27; &#x3D;&gt; false,
            &#x27;method&#x27; &#x3D;&gt; false,
            &#x27;lambda&#x27; &#x3D;&gt; false,
            &#x27;mustlok&#x27; &#x3D;&gt; false,
            &#x27;mustlam&#x27; &#x3D;&gt; false,
            &#x27;echo&#x27; &#x3D;&gt; false,
            &#x27;partnc&#x27; &#x3D;&gt; false,
            &#x27;knohlp&#x27; &#x3D;&gt; false,
            &#x27;debug&#x27; &#x3D;&gt; isset($options[&#x27;debug&#x27;]) ? $options[&#x27;debug&#x27;] : 1,
        ),
        &#x27;constants&#x27; &#x3D;&gt;  array(
            &#x27;DEBUG_ERROR_LOG&#x27; &#x3D;&gt; 1,
            &#x27;DEBUG_ERROR_EXCEPTION&#x27; &#x3D;&gt; 2,
            &#x27;DEBUG_TAGS&#x27; &#x3D;&gt; 4,
            &#x27;DEBUG_TAGS_ANSI&#x27; &#x3D;&gt; 12,
            &#x27;DEBUG_TAGS_HTML&#x27; &#x3D;&gt; 20,
        ),
        &#x27;helpers&#x27; &#x3D;&gt; isset($options[&#x27;helpers&#x27;]) ? array_merge($helpers, $options[&#x27;helpers&#x27;]) : $helpers,
        &#x27;partials&#x27; &#x3D;&gt; isset($options[&#x27;partials&#x27;]) ? array_merge($partials, $options[&#x27;partials&#x27;]) : $partials,
        &#x27;scopes&#x27; &#x3D;&gt; array(),
        &#x27;sp_vars&#x27; &#x3D;&gt; isset($options[&#x27;data&#x27;]) ? array_merge(array(&#x27;root&#x27; &#x3D;&gt; $in), $options[&#x27;data&#x27;]) : array(&#x27;root&#x27; &#x3D;&gt; $in),
        &#x27;blparam&#x27; &#x3D;&gt; array(),
        &#x27;partialid&#x27; &#x3D;&gt; 0,
        &#x27;runtime&#x27; &#x3D;&gt; &#x27;\LightnCandy\Runtime&#x27;,
    );
    
    return &#x27;&#x27;.lcr586c79706521eencq($cx, lcr586c79706521ehbch($cx, &#x27;foo&#x27;, array(array(),array()), &#x27;encq&#x27;, $in)).&#x27;, &#x27;.lcr586c79706521eencq($cx, lcr586c79706521ehbch($cx, &#x27;bar&#x27;, array(array(),array()), &#x27;encq&#x27;, $in)).&#x27;&#x27;;
};

&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
The Output:
You&amp;Me!, He&amp;She!</code></pre>
  <a name="SeeAlso..."></a><a class="glyphicon glyphicon-pushpin" href="#SeeAlso..."></a>
<h2>See Also...</h2>
<ul class="ref">
 <li><a href="9003-helperescaping.html">LightnCandy: Use SafeString</a></li>
 <li><a href="9900-lc-options.html">LightnCandy options</a></li>
 <li><a href="LC-FLAG_STANDALONEPHP.html">LightnCandy option: FLAG_STANDALONEPHP</a></li>
</ul>
<ul class="pager">
 <li class="previous"><a href="9902-lcop-partialresolver.html"><span class="glyphicon glyphicon-arrow-left"></span> LightnCandy option: partialresolver</a></li>
 <li class="next"><a href="LC-FLAG_ADVARNAME.html">LightnCandy option: FLAG_ADVARNAME <span class="glyphicon glyphicon-arrow-right"></span></a></li>
</ul>
<script>
(function() {
 var cx = '015786516026450061497:ydk5o8cxglu';
 var gcse = document.createElement('script');
 gcse.type = 'text/javascript';
 gcse.async = true;
 gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
 var s = document.getElementsByTagName('script')[0];
 s.parentNode.insertBefore(gcse, s);
})();
</script>
<div class="search">
<h3>Search the cookbook</h3>
<gcse:search></gcse:search>
</div>
<div class="footer">
Generated at 2017-01-04T04:26:00.870Z
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/clipboard.js/1.5.3/clipboard.min.js"></script>
<script>
if (document.execCommand) {
    new Clipboard('.btn[data-clipboard-target]');
} else {
    $('.btn[data-clipboard-target]').hide();
}

$(document).keydown(function (e) {
  var A;

  if ($('#gsc-i-id1').is(':focus')) {
      return;
  }

  switch (e.keyCode) {
  case 37:
    A = $('.pager .previous a').attr('href');
    break;
  case 39:
    A = $('.pager .next a').attr('href');
    break;
  case 191:
    return setTimeout(function () {
        $('#gsc-i-id1').focus();
    }, 1);
  case 190:
    return $('ul.ref li:first-child a').focus();
  case 188:
    return $('.navbar .nav .dropdown .dropdown-toggle').trigger('click');
  }
  if (A) {
    location.href = A;
  }
});
</script>
</body>
</html>
